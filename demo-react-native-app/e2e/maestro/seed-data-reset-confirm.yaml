# Maestro E2E test for Reset Confirmation Flow
# Verifies the full reset flow - confirms reset and verifies data is restored
#
# Prerequisites:
#   - Android emulator running: adb devices
#   - App installed (see MAESTRO_TESTING.md for options)
#
# Run with: maestro test e2e/maestro/seed-data-reset-confirm.yaml

appId: com.vitorsilvavmrs.saborspin
---
# Clear app state for consistent testing
- clearState
# Launch app
- launchApp

# Verify home screen loads
- extendedWaitUntil:
    visible: "SaborSpin"
    timeout: 30000

# Navigate to Settings tab
- tapOn: "Settings"

# Wait for settings screen to load
- extendedWaitUntil:
    visible: "Settings"
    timeout: 10000

# Scroll down to find Data Management section
- scrollUntilVisible:
    element: "Reset to Default Data"
    direction: DOWN
    timeout: 15000
    speed: 60

# Take screenshot before reset
- takeScreenshot: seed-data-05-before-reset

# Tap on Reset to Default Data button
- tapOn:
    id: "reset-app-data-button"

# Wait for confirmation modal
- extendedWaitUntil:
    visible: "Reset App Data?"
    timeout: 5000

# Verify confirmation modal content
- assertVisible: "Reset App Data?"
- assertVisible: "All your data will be replaced"

# Take screenshot of confirmation modal
- takeScreenshot: seed-data-06-confirm-modal-before-confirm

# Tap Confirm/Reset button to proceed with reset
- tapOn:
    id: "confirm-reset-button"

# Wait for reset to complete
- extendedWaitUntil:
    timeout: 5000

# Wait for animations to complete
- waitForAnimationToEnd

# Take screenshot after reset
- takeScreenshot: seed-data-07-after-reset

# Navigate to Categories to verify seeded data
- tapOn: "Categories"

# Wait for categories screen to load
- extendedWaitUntil:
    visible: "Categories"
    timeout: 10000

# Verify seeded categories are present
- assertVisible: "Fruits"
- assertVisible: "Dairy"

# Take screenshot of categories after reset
- takeScreenshot: seed-data-08-categories-after-reset

# Navigate to Ingredients to verify seeded data
- tapOn: "Ingredients"

# Wait for ingredients screen to load
- extendedWaitUntil:
    visible: "Ingredients"
    timeout: 10000

# Verify seeded ingredients are present
- assertVisible: "Milk"

# Take screenshot of ingredients after reset
- takeScreenshot: seed-data-09-ingredients-after-reset

# Test passed - Full reset flow works correctly
