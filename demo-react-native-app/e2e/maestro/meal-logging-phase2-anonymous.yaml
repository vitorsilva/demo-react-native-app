# Maestro E2E test for Phase 2 Anonymous Meal Logging
# Tests logging a meal without a name (anonymous meal with components)
#
# Prerequisites:
#   - Android emulator running: adb devices
#   - App installed (see MAESTRO_TESTING.md for options)
#
# Run with: maestro test e2e/maestro/meal-logging-phase2-anonymous.yaml

appId: com.vitorsilvavmrs.saborspin
---
# Launch app
- launchApp

# Verify home screen loads
- extendedWaitUntil:
    visible: "SaborSpin"
    timeout: 30000

# Take screenshot of initial home screen
- takeScreenshot: phase2-anon-01-home

# Navigate to snack suggestions (different meal type)
- tapOn:
    text: "snack Ideas"
    optional: false

# Wait for suggestions screen to load
- extendedWaitUntil:
    visible: "Pick one:"
    timeout: 15000

# Take screenshot of snack suggestions
- takeScreenshot: phase2-anon-02-suggestions

# Select first suggestion to open confirmation modal
- tapOn:
    id: "select-button-0"

# Wait for confirmation modal
- extendedWaitUntil:
    id: "meal-name-input"
    timeout: 10000

# Verify meal name input is visible (we'll leave it empty)
- assertVisible:
    id: "meal-name-input"

# Take screenshot showing empty name input
- takeScreenshot: phase2-anon-03-modal-no-name

# Open preparation method picker for first ingredient
- tapOn:
    id: "meal-component-0"

# Wait for prep method picker
- extendedWaitUntil:
    id: "prep-method-prep-raw"
    timeout: 10000

# Select "raw" preparation method
- tapOn:
    id: "prep-method-prep-raw"

# Wait for picker to close
- extendedWaitUntil:
    id: "done-button"
    timeout: 5000

# Verify raw method is shown
- assertVisible:
    text: "raw"

# Take screenshot with prep method but no name
- takeScreenshot: phase2-anon-04-prep-selected-no-name

# Complete the logging (without entering a name)
- tapOn:
    id: "done-button"

# Wait to return to home screen
- extendedWaitUntil:
    visible: "Recent Meals"
    timeout: 10000

# Verify meal appears in Recent Meals
- assertVisible: "Today"

# Take screenshot of home after logging anonymous meal
- takeScreenshot: phase2-anon-05-home-after

# Test passed - Anonymous meal logging with prep method works on mobile
